{
  "query": "LegacyScoringUtil.calculateBaseScore",
  "focus_node": "AbstractBaseStrategy.passBasicRiskCheck",
  "seed_nodes": [
    {
      "node_id": "LegacyScoringUtil.calculateBaseScore",
      "score": 1.0
    }
  ],
  "nodes": [
    {
      "node_id": "LegacyScoringUtil.calculateBaseScore",
      "name": "calculateBaseScore",
      "type": "Method",
      "file_path": "/Users/lixiaoying/lxy/code/Code Refactoring/graph_rag_context_engine/data/marketing-demo/src/main/java/com/icbc/marketing/core/LegacyScoringUtil.java",
      "start_line": 19,
      "end_line": 25,
      "signature": "public static double calculateBaseScore(Map<String, Object> flinkFeatures)",
      "docstring": "/**\n     * Calculates a base user score.\n     * @deprecated Logic is outdated, should be refactored to handle \"Region\" context.\n     */",
      "snippet": "    public static double calculateBaseScore(Map<String, Object> flinkFeatures) {\n        double txnVolume = (double) flinkFeatures.getOrDefault(\"last_1h_txn_amt\", 0.0);\n        int loginCount = (int) flinkFeatures.getOrDefault(\"login_count_7d\", 0);\n\n        // Simple linear hard-coded logic\n        return (txnVolume * 0.001) + (loginCount * 10) * GOLDEN_RATIO;\n    }\n",
      "role": "focus",
      "roles": [
        "focus",
        "same_file_helper",
        "seed"
      ],
      "highlight_span": {
        "start_line": 19,
        "end_line": 19
      },
      "why": [
        "focus node (exact match or top seed)",
        "seed via vector search (score=1.000)",
        "same file helper (/Users/lixiaoying/lxy/code/Code Refactoring/graph_rag_context_engine/data/marketing-demo/src/main/java/com/icbc/marketing/core/LegacyScoringUtil.java)"
      ]
    },
    {
      "node_id": "LegacyScoringUtil.GOLDEN_RATIO",
      "name": "GOLDEN_RATIO",
      "type": "Field",
      "file_path": "/Users/lixiaoying/lxy/code/Code Refactoring/graph_rag_context_engine/data/marketing-demo/src/main/java/com/icbc/marketing/core/LegacyScoringUtil.java",
      "start_line": 13,
      "end_line": 13,
      "signature": "double GOLDEN_RATIO = 0.618",
      "docstring": "// Magic number alert: 0.618",
      "snippet": "    private static final double GOLDEN_RATIO = 0.618;\n",
      "role": "same_class_member",
      "roles": [
        "same_class_member",
        "same_file_helper"
      ],
      "highlight_span": {
        "start_line": 13,
        "end_line": 13
      },
      "why": [
        "same class member of LegacyScoringUtil",
        "same file helper (/Users/lixiaoying/lxy/code/Code Refactoring/graph_rag_context_engine/data/marketing-demo/src/main/java/com/icbc/marketing/core/LegacyScoringUtil.java)"
      ]
    },
    {
      "node_id": "LegacyScoringUtil.isBlacklisted",
      "name": "isBlacklisted",
      "type": "Method",
      "file_path": "/Users/lixiaoying/lxy/code/Code Refactoring/graph_rag_context_engine/data/marketing-demo/src/main/java/com/icbc/marketing/core/LegacyScoringUtil.java",
      "start_line": 27,
      "end_line": 30,
      "signature": "public static boolean isBlacklisted(String userId)",
      "docstring": "",
      "snippet": "    public static boolean isBlacklisted(String userId) {\n        // Mock DB call\n        return userId.startsWith(\"B_\");\n    }\n",
      "role": "same_class_member",
      "roles": [
        "same_class_member",
        "same_file_helper"
      ],
      "highlight_span": {
        "start_line": 27,
        "end_line": 27
      },
      "why": [
        "same class member of LegacyScoringUtil",
        "same file helper (/Users/lixiaoying/lxy/code/Code Refactoring/graph_rag_context_engine/data/marketing-demo/src/main/java/com/icbc/marketing/core/LegacyScoringUtil.java)"
      ]
    },
    {
      "node_id": "LegacyScoringUtil",
      "name": "LegacyScoringUtil",
      "type": "Class",
      "file_path": "/Users/lixiaoying/lxy/code/Code Refactoring/graph_rag_context_engine/data/marketing-demo/src/main/java/com/icbc/marketing/core/LegacyScoringUtil.java",
      "start_line": 10,
      "end_line": 31,
      "signature": "public class LegacyScoringUtil",
      "docstring": "/**\n * [Legacy Component]\n * A static utility class used across the system for basic scoring.\n * Refactoring Target: High coupling. If this changes, everything breaks.\n */",
      "snippet": "public class LegacyScoringUtil {\n\n    // Magic number alert: 0.618\n    private static final double GOLDEN_RATIO = 0.618;\n\n    /**\n     * Calculates a base user score.\n     * @deprecated Logic is outdated, should be refactored to handle \"Region\" context.\n     */\n    public static double calculateBaseScore(Map<String, Object> flinkFeatures) {\n        double txnVolume = (double) flinkFeatures.getOrDefault(\"last_1h_txn_amt\", 0.0);\n        int loginCount = (int) flinkFeatures.getOrDefault(\"login_count_7d\", 0);\n\n        // Simple linear hard-coded logic\n        return (txnVolume * 0.001) + (loginCount * 10) * GOLDEN_RATIO;\n    }\n\n    public static boolean isBlacklisted(String userId) {\n        // Mock DB call\n        return userId.startsWith(\"B_\");\n    }\n}",
      "role": "same_file_helper",
      "roles": [
        "same_file_helper"
      ],
      "highlight_span": {
        "start_line": 10,
        "end_line": 10
      },
      "why": [
        "same file helper (/Users/lixiaoying/lxy/code/Code Refactoring/graph_rag_context_engine/data/marketing-demo/src/main/java/com/icbc/marketing/core/LegacyScoringUtil.java)"
      ]
    }
  ],
  "edges": [
    {
      "source": "LegacyScoringUtil",
      "target": "LegacyScoringUtil.GOLDEN_RATIO",
      "relation": "CONTAINS",
      "file_path": null,
      "line": null
    },
    {
      "source": "LegacyScoringUtil",
      "target": "LegacyScoringUtil.isBlacklisted",
      "relation": "CONTAINS",
      "file_path": null,
      "line": null
    },
    {
      "source": "LegacyScoringUtil",
      "target": "LegacyScoringUtil.calculateBaseScore",
      "relation": "CONTAINS",
      "file_path": null,
      "line": null
    }
  ],
  "focus": {
    "node_id": "LegacyScoringUtil.calculateBaseScore"
  },
  "call_graph": {
    "callees": [],
    "callers": []
  },
  "data_flow": {
    "read_fields": [],
    "written_fields": []
  },
  "same_class": [
    "LegacyScoringUtil",
    "LegacyScoringUtil.GOLDEN_RATIO",
    "LegacyScoringUtil.calculateBaseScore",
    "LegacyScoringUtil.isBlacklisted"
  ],
  "same_file": [
    "LegacyScoringUtil",
    "LegacyScoringUtil.GOLDEN_RATIO",
    "LegacyScoringUtil.calculateBaseScore",
    "LegacyScoringUtil.isBlacklisted"
  ],
  "stats": {
    "seed_top_k": 5,
    "hops": 0,
    "selected_nodes": 4,
    "selected_edges": 3
  },
  "expected_files": [
    "src/main/java/com/icbc/marketing/core/ScoringService.java",
    "src/main/java/com/icbc/marketing/service/CampaignDecisionEngine.java",
    "src/main/java/com/icbc/marketing/strategy/AbstractBaseStrategy.java"
  ],
  "focus_node_after": "ScoringService.computeBaseScoreForRiskCheck"
}